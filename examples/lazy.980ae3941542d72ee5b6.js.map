{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/olcs/contrib/LazyLoader.js","webpack:///./src/olcs/contrib/Manager.js","webpack:///./examples/lazy.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","11","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","url","this","promise","url_","load","_this","Promise","resolve","reject","script","document","createElement","onload","onerror","head","appendChild","src","Manager","_olObservable","cesiumUrl","_temp","_ref","map","cameraExtentInRadians","cesiumUrl_","boundingSphere_","blockLimiter_","promise_","ol3d","cesiumInitialTilt_","toRadians","fogDensity","fogSSEFactor","minimumZoomDistance","maximumZoomDistance","limitCameraToBoundingSphereRatio","height","_proto","_this2","cesiumLazyLoader","olcsContribLazyLoader","then","onCesiumLoaded","rect","_construct","Cesium","Rectangle","Camera","DEFAULT_VIEW_RECTANGLE","BoundingSphere","fromRectangle3D","Ellipsoid","WGS84","instantiateOLCesium","scene","getCesiumScene","configureForUsability","configureForPerformance","dispatchEvent","OLCesium","terrainProvider","createWorldTerrain","fog","enabled","density","screenSpaceErrorFactor","sscController","screenSpaceCameraController","globe","depthTestAgainstTerrain","baseColor","Color","WHITE","backgroundColor","postRender","addEventListener","limitCameraToBoundingSphere","enableAutoRenderLoop","_this3","camera","position","carto","Cartographic","fromCartesian","ratio","Cartesian3","distance","center","radius","flying","unblockLimiter","flyToBoundingSphere","complete","cancel","toggle3d","_this4","is3DCurrentlyEnabled","getEnabled","olcsCore","resetToNorthZenith","setEnabled","rotateAroundBottomCenter","set3dWithView","lon","lat","elevation","headingDeg","pitchDeg","_this5","destination","fromDegrees","orientation","heading","Math","pitch","roll","setView","is3dEnabled","getHeading","getView","getRotation","getTiltOnGlobe","computeSignedTiltAngleOnGlobe","setHeading","angle","bottom","pickBottomPoint","setHeadingUsingBottomCenter","getOl3d","getOlView","getCesiumViewMatrix","viewMatrix","flyToRectangle","rectangle","offset","_this6","getRectangleCameraCoordinates","mag","magnitude","normalize","multiplyByScalar","flyTo","endTransform","Matrix4","IDENTITY","getCameraExtentRectangle","olObservable","ol2d","Map","layers","Tile","source","OSM","controls","util","attributionOptions","collapsible","target","view","View","proj","zoom","contrib_Manager","CESIUM_URL","__webpack_exports__"],"mappings":"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","file":"lazy.980ae3941542d72ee5b6.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t11: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([174,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","/**\n * @module olcs.contrib.LazyLoader\n */\nconst exports = class {\n  /**\n   * @param {string} url\n   * @struct\n   * @api\n   */\n  constructor(url) {\n    /**\n     * @type {Promise<undefined>}\n     * @protected\n     */\n    this.promise;\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.url_ = url;\n  }\n\n  /**\n   * @return {Promise<undefined>}\n   * @api\n   */\n  load() {\n    if (!this.promise) {\n      // not yet loading\n      this.promise = new Promise((resolve, reject) => {\n        const script = document.createElement('script');\n        script.onload = () => resolve();\n        script.onerror = () => reject();\n        document.head.appendChild(script);\n        script.src = this.url_;\n      });\n    }\n    return this.promise;\n  }\n};\n\n\nexport default exports;\n","/**\n * @module olcs.contrib.Manager\n */\nimport olcsContribLazyLoader from '../contrib/LazyLoader.js';\nimport OLCesium from '../OLCesium.js';\nimport olcsCore from '../core.js';\nimport {toRadians} from '../math.js';\nimport olObservable from 'ol/Observable.js';\n\n\n/**\n * @typedef {Object} ManagerOptions\n * @property {import('ol/Map.js').default} map\n * @property {import('ol/extent.js').Extent} [cameraExtentInRadians]\n */\n\n\nconst Manager = class extends olObservable {\n  /**\n   * @param {string} cesiumUrl\n   * @param {olcsx.contrib.ManagerOptions} options\n   * @api\n   */\n  constructor(cesiumUrl, {map, cameraExtentInRadians} = {}) {\n\n    super();\n\n    /**\n     * @type {string}\n     * @private\n     */\n    this.cesiumUrl_ = cesiumUrl;\n\n    /**\n     * @type {ol.Map}\n     * @protected\n     */\n    this.map = map;\n\n    /**\n     * @type {ol.Extent}\n     * @protected\n     */\n    this.cameraExtentInRadians = cameraExtentInRadians || null;\n\n    /**\n     * @private\n     * @type {Cesium.BoundingSphere}\n     */\n    this.boundingSphere_;\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.blockLimiter_ = false;\n\n    /**\n     * @type {Promise.<olcs.OLCesium>}\n     * @private\n     */\n    this.promise_;\n\n    /**\n     * @type {olcs.OLCesium}\n     * @protected\n     */\n    this.ol3d;\n\n\n    /**\n     * @const {number} Tilt angle in radians\n     * @private\n     */\n    this.cesiumInitialTilt_ = toRadians(50);\n\n    /**\n     * @protected\n     * @type {number}\n     */\n    this.fogDensity = 0.0001;\n\n    /**\n     * @protected\n     * @type {number}\n     */\n    this.fogSSEFactor = 25;\n\n    /**\n     * Limit the minimum distance to the terrain to 2m.\n     * @protected\n     * @type {number}\n     */\n    this.minimumZoomDistance = 2;\n\n    /**\n     * Limit the maximum distance to the earth to 10'000km.\n     * @protected\n     * @type {number}\n     */\n    this.maximumZoomDistance = 10000000;\n\n    // when closer to 3000m, restrict the available positions harder\n    /**\n     * @protected\n     * @param {number} height\n     */\n    this.limitCameraToBoundingSphereRatio = height => (height > 3000 ? 9 : 3);\n  }\n\n\n  /**\n   * @return {Promise.<olcs.OLCesium>}\n   */\n  load() {\n    if (!this.promise_) {\n      const cesiumLazyLoader = new olcsContribLazyLoader(this.cesiumUrl_);\n      this.promise_ = cesiumLazyLoader.load().then(() => this.onCesiumLoaded());\n    }\n    return this.promise_;\n  }\n\n\n  /**\n   * @protected\n   * @return {olcs.OLCesium}\n   */\n  onCesiumLoaded() {\n    if (this.cameraExtentInRadians) {\n      const rect = new Cesium.Rectangle(...this.cameraExtentInRadians);\n      // Set the fly home rectangle\n      Cesium.Camera.DEFAULT_VIEW_RECTANGLE = rect;\n      this.boundingSphere_ = Cesium.BoundingSphere.fromRectangle3D(rect, Cesium.Ellipsoid.WGS84, 300); // lux mean height is 300m\n    }\n\n    this.ol3d = this.instantiateOLCesium();\n    const scene = this.ol3d.getCesiumScene();\n    this.configureForUsability(scene);\n    this.configureForPerformance(scene);\n    this.dispatchEvent('load');\n    return this.ol3d;\n  }\n\n\n  /**\n   * Application code should override this method.\n   * @return {olcs.OLCesium}\n   */\n  instantiateOLCesium() {\n    console.assert(this.map);\n    const ol3d = new OLCesium({map: this.map});\n    const scene = ol3d.getCesiumScene();\n    const terrainProvider = Cesium.createWorldTerrain();\n    scene.terrainProvider = terrainProvider;\n    return ol3d;\n  }\n\n\n  /**\n   * @param {!Cesium.Scene} scene The scene, passed as parameter for convenience.\n   * @protected\n   */\n  configureForPerformance(scene) {\n    const fog = scene.fog;\n    fog.enabled = true;\n    fog.density = this.fogDensity;\n    fog.screenSpaceErrorFactor = this.fogSSEFactor;\n  }\n\n\n  /**\n   * @param {!Cesium.Scene} scene The scene, passed as parameter for convenience.\n   * @protected\n   */\n  configureForUsability(scene) {\n    const sscController = scene.screenSpaceCameraController;\n    sscController.minimumZoomDistance = this.minimumZoomDistance;\n    sscController.maximumZoomDistance = this.maximumZoomDistance;\n\n    // Do not see through the terrain. Seeing through the terrain does not make\n    // sense anyway, except for debugging\n    scene.globe.depthTestAgainstTerrain = true;\n\n    // Use white instead of the black default colour for the globe when tiles are missing\n    scene.globe.baseColor = Cesium.Color.WHITE;\n    scene.backgroundColor = Cesium.Color.WHITE;\n\n    if (this.boundingSphere_) {\n      scene.postRender.addEventListener(this.limitCameraToBoundingSphere.bind(this), scene);\n    }\n    // Stop rendering Cesium when there is nothing to do. This drastically reduces CPU/GPU consumption.\n    this.ol3d.enableAutoRenderLoop();\n  }\n\n\n  /**\n   * Constrain the camera so that it stays close to the bounding sphere of the map extent.\n   * Near the ground the allowed distance is shorter.\n   * @protected\n   */\n  limitCameraToBoundingSphere() {\n    if (this.boundingSphere_ && !this.blockLimiter_) {\n      const scene = this.ol3d.getCesiumScene();\n      const camera = scene.camera;\n      const position = camera.position;\n      const carto = Cesium.Cartographic.fromCartesian(position);\n      const ratio = this.limitCameraToBoundingSphereRatio(carto.height);\n      if (Cesium.Cartesian3.distance(this.boundingSphere_.center, position) > this.boundingSphere_.radius * ratio) {\n        const currentlyFlying = camera.flying;\n        if (currentlyFlying === true) {\n          // There is a flying property and its value is true\n          return;\n        } else {\n          this.blockLimiter_ = true;\n          const unblockLimiter = () => this.blockLimiter_ = false;\n          camera.flyToBoundingSphere(this.boundingSphere_, {\n            complete: unblockLimiter,\n            cancel: unblockLimiter\n          });\n        }\n      }\n    }\n  }\n\n\n  /**\n   * Enable or disable ol3d with a default animation.\n   * @export\n   * @return {Promise<undefined>}\n   */\n  toggle3d() {\n    return this.load().then((/** @const {!olcs.OLCesium} */ ol3d) => {\n      const is3DCurrentlyEnabled = ol3d.getEnabled();\n      const scene = ol3d.getCesiumScene();\n      if (is3DCurrentlyEnabled) {\n        // Disable 3D\n        console.assert(this.map);\n        return olcsCore.resetToNorthZenith(this.map, scene).then(() => {\n          ol3d.setEnabled(false);\n          this.dispatchEvent('toggle');\n        });\n      } else {\n        // Enable 3D\n        ol3d.setEnabled(true);\n        this.dispatchEvent('toggle');\n        return olcsCore.rotateAroundBottomCenter(scene, this.cesiumInitialTilt_);\n      }\n    });\n  }\n\n\n  /**\n   * Enable ol3d with a view built from parameters.\n   *\n   * @export\n   * @param {number} lon\n   * @param {number} lat\n   * @param {number} elevation\n   * @param {number} headingDeg Heading value in degrees.\n   * @param {number} pitchDeg Pitch value in degrees.\n   * @returns {Promise<undefined>}\n   */\n  set3dWithView(lon, lat, elevation, headingDeg, pitchDeg) {\n    return this.load().then((/** @const {!olcs.OLCesium} */ ol3d) => {\n      const is3DCurrentlyEnabled = ol3d.getEnabled();\n      const scene = ol3d.getCesiumScene();\n      const camera = scene.camera;\n      const destination = Cesium.Cartesian3.fromDegrees(lon, lat, elevation);\n      const heading = Cesium.Math.toRadians(headingDeg);\n      const pitch = Cesium.Math.toRadians(pitchDeg);\n      const roll = 0;\n      const orientation = {heading, pitch, roll};\n\n      if (!is3DCurrentlyEnabled) {\n        ol3d.setEnabled(true);\n        this.dispatchEvent('toggle');\n      }\n\n      camera.setView({\n        destination,\n        orientation\n      });\n    });\n  }\n\n\n  /**\n   * @export\n   * @return {boolean}\n   */\n  is3dEnabled() {\n    return !!this.ol3d && this.ol3d.getEnabled();\n  }\n\n\n  /**\n   * @return {number}\n   */\n  getHeading() {\n    return this.map ? this.map.getView().getRotation() || 0 : 0;\n  }\n\n\n  /**\n   * @return {number|undefined}\n   */\n  getTiltOnGlobe() {\n    const scene = this.ol3d.getCesiumScene();\n    const tiltOnGlobe = olcsCore.computeSignedTiltAngleOnGlobe(scene);\n    return -tiltOnGlobe;\n  }\n\n\n  /**\n   * @param {number} angle\n   */\n  setHeading(angle) {\n    const scene = this.ol3d.getCesiumScene();\n    const bottom = olcsCore.pickBottomPoint(scene);\n    if (bottom) {\n      olcsCore.setHeadingUsingBottomCenter(scene, angle, bottom);\n    }\n  }\n\n  /**\n   * @export\n   * @return {olcs.OLCesium}\n   */\n  getOl3d() {\n    return this.ol3d;\n  }\n\n  /**\n   * @export\n   * @return {!ol.View}\n   */\n  getOlView() {\n    const view = this.map.getView();\n    console.assert(view);\n    return view;\n  }\n\n  /**\n   * @export\n   * @return {Cesium.Matrix4}\n   */\n  getCesiumViewMatrix() {\n    return this.ol3d.getCesiumScene().camera.viewMatrix;\n  }\n\n  /**\n   * @export\n   * @return {!Cesium.Scene}\n   */\n  getCesiumScene() {\n    return this.ol3d.getCesiumScene();\n  }\n\n  /**\n   * @export\n   * @param {!Cesium.Rectangle} rectangle\n   * @param {number=} offset in meters\n   * @return {Promise<undefined>}\n   */\n  flyToRectangle(rectangle, offset = 0) {\n    const camera = this.getCesiumScene().camera;\n    const destination = camera.getRectangleCameraCoordinates(rectangle);\n\n    const mag = Cesium.Cartesian3.magnitude(destination) + offset;\n    Cesium.Cartesian3.normalize(destination, destination);\n    Cesium.Cartesian3.multiplyByScalar(destination, mag, destination);\n\n    return new Promise((resolve, reject) => {\n      if (!this.cameraExtentInRadians) {\n        reject();\n        return;\n      }\n\n      camera.flyTo({\n        destination,\n        complete: () => resolve(),\n        cancel: () => reject(),\n        endTransform: Cesium.Matrix4.IDENTITY\n      });\n    });\n  }\n\n  /**\n   * @protected\n   * @return {Cesium.Rectangle|undefined}\n   */\n  getCameraExtentRectangle() {\n    if (this.cameraExtentInRadians) {\n      return new Cesium.Rectangle(...this.cameraExtentInRadians);\n    }\n  }\n};\n\n\nexport default Manager;\n","/**\n * @module examples.lazy\n */\nconst exports = {};\nimport {transform} from 'ol/proj.js';\nimport olView from 'ol/View.js';\nimport {defaults as olControlDefaults} from 'ol/control.js';\nimport olSourceOSM from 'ol/source/OSM.js';\nimport olLayerTile from 'ol/layer/Tile.js';\nimport olMap from 'ol/Map.js';\nimport olcsContribManager from 'olcs/contrib/Manager.js';\n\n\nconst ol2d = new olMap({\n  layers: [\n    new olLayerTile({\n      source: new olSourceOSM()\n    })\n  ],\n  controls: olControlDefaults({\n    attributionOptions: /** @type {olx.control.AttributionOptions} */ ({\n      collapsible: false\n    })\n  }),\n  target: 'map',\n  view: new olView({\n    center: transform([25, 20], 'EPSG:4326', 'EPSG:3857'),\n    zoom: 3\n  })\n});\n\n\nwindow['manager'] = new olcsContribManager(window.CESIUM_URL, {map: ol2d});\n\n\nexport default exports;\n"],"sourceRoot":""}